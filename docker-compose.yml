services:
  invokeai:
    container_name: invokeai
    image: 'ghcr.io/invoke-ai/invokeai:${IMAGE_TAG:-main-rocm}'
    extends:
      file: 'gpu-support.yml'
      service: '${GPU_DRIVER:-rocm}'
    ports:
      - '${BIND_ADDRESS:-127.0.0.1}:${BIND_PORT:-9090}:9090'
    volumes:
      - '${DATA_DIR:-./data}:/invokeai'
      - '${HF_CACHE_DIR:-./cache/huggingface}:/invokeai/.cache/huggingface'
      - '/etc/localtime:/etc/localtime:ro'
    env_file: '.env'
    restart: unless-stopped
    logging:
      driver: 'json-file'
      options:
        max-size: '${LOG_MAX_SIZE:-5m}'
        max-file: '${LOG_MAX_FILE:-5}'
